# 电力系统网损优化

1. 输入输出

   输入：一个电力系统的潮流参数和线路本身的参数

* 节点数：N，节点的负载情况和发电机分布情况（确定节点的类型PV还是PQ还是平衡）
* 线路数：M，线路电路参数
* 节点或者线路能够进行的操作列表
* 已经计算好的线路瞬时潮流（计算网损） 

输出：应该在何处采取何种电力操作

* 220KV线路上的串联电容还是电感

通过改变线路的电路参数重新计算一次网损

* 线路改变并列方式（双线单线的切换）

  也是线路的电路参数

* 变压器的并列方式

  修改变压器模型中的电路参数 X

* 母线上的并联电容或者电抗器

* 同步调相机改变节点相位

* 同步调相机，STATCOM等无功电源

  电力系统中的主要负载是异步电动机和变压器，需要从电网汲取大量的无功，在负载过大的时候，会造成电网的功率因数下降，造成线路的损耗上升。所以可以在受电端投入发出无功的同步调相机，这能够改善系统的功率因数，使得系统传输的无功减少，进而降低网损。

  比如在电网重载运行的时候，让调相机运行在过励的状态，可以增加电网中的滞后电流。

  STATCOM是电力电子器件，是利用自换相桥式电路，经过电抗器并联在电网上，适当地调节桥式电路交流侧输出电压的幅值和相位，或者直接控制其交流侧电流，就可以使该电路吸收或者发出满足要求的无功电流，实现动态无功补偿的目的。所以在原理上和前面的同步调相机很像，就是尽量实现无功的就地补偿，减少线路损失。

* 调节发电机的无功出力

  数字控制的自动励磁系统，通过控制励磁电流改变发电机的无功。建立负反馈的传递函数。

* 改变变压器的变比

  12.3节电力系统课本关于利用无功功率补偿调压

2. 电网拓扑分割

3. 程序模型

* 线路模型 Line：每条线路的网损，计算接口：

  `calcLineLoss();`

* 节点模型 Bus：每个节点的历史电价，平均值作为实时电价，作为网损代价的一部分

  计算接口：`updatePrice();`

* 变压器模型 Transformer：变压器的台数（并联运行的模式），

  计算接口：`calcTansformerLoss();`

* 总体网架结构 `grid_220`: 包括上面的三个对象模型，然后包含一些计算的接口。

  `calcPowerFlowLoss()`	

  `lossJudge();`  // 查看网络中网损情况最严重，优先等级较高的区域进行处理

4. 如何按照已经得到的数据建立优化的模型

   * 约束条件

     1. 电力系统的等式平衡
        $$
        P_i = V_i \sum_{j\in h} V_j(G_{ij}cos\delta_{ij}+B_{ij}sin\delta_{ij})\\
        Q_i = V_i \sum_{j\in h} V_j(G_{ij}cos\delta_{ij}-B_{ij}sin\delta_{ij})
        $$

     2. 电力系统的不等式平衡
        $$
        V_{gmin} \leq V_{gi} \leq V_{gmax}\\
        	Q_{cmin} \leq Q_{ci} \leq Q_{cmax}\\
        	T_{imin} \leq T_{i} \leq T_{imax}\\
        $$

     3. 目标函数
        $$
        F = min [\omega P_{\Delta} + \omega_2 \sum_{i=1}^{N}(\frac{\Delta V_i} {V_{imax}-V_{imin}}) ^ 2 + \omega_3 \sum_{i=1}^{N} (\Delta Q_i)^2]
        $$
        第一项考虑网损值，第二项考虑了超过节点电压超过额定值的罚项，第三项考虑了无功超过界限的罚项。

        看到论文中对控制变量的编码是什么意思？

        比如有投切的电抗电容器的组数，变压器分接头的挡数，实际发电机机端电压，等等。

        * 并联电容电抗器

          把有并联电容电抗的节点处看做PV节点，最后优化算出的无功值可以转化为具体的电抗电容值。

          或者让有并联电容电抗器的节点的参数$G_{ij}$ 和 $B_{ij}$  作为变量参与优化。

        * 线路改变并列方式

          